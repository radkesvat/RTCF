
خوب کاری که اینجا باید انجام بدیم اینه که یه دامنه که در اختیار داریم رو ببریم پشت کلود فلیر و براش سرتیفکیت بگیریم

اموزش کار با کلود توی یوتویوب به زبان فارسی هست ؛ پس اگه با کلودفلیر هیچ آشنایی ندارید اونا رو ببینید حتما

در ابتدا دامنه باید بخریم ؛ من یه ir گرفتم و پیشناهاد میکنم شما هم ir داشته باشین که کمترین ریسک فیلتر شدن رو داره

سپس اینجا داخل کلود دامنه رو وارد میکنیم

![image](https://github.com/radkesvat/RTCF/assets/134321679/ce040628-7c9e-417b-889f-81ef2a49f7a4)


سپس پلن رو میزنیم free

![image](https://github.com/radkesvat/RTCF/assets/134321679/fdcb8965-4e44-4c2a-9d37-3312349c11a4)


در این مرحله ازمون میخواد یک رکورد dns اضافه کنیم که مثل عکس اضافه کنید ؛ دقت کنید ایپی سرور ایرانتونو باید اینجا وارد کنید و بعد روی save کلیک کنید 

![image](https://github.com/radkesvat/RTCF/assets/134321679/99cc6653-61e4-4824-81a5-534ade7d3994)


در مرحله بعد کلود فلیر به شما دوتا name server میده ؛ اینا رو کپی میکنید میبرید توی پنل وبسایتی که ازش دامنه رو خریداری کردید (برای دامنه های ir میشه nic.ir) و جا گزاری میکنید 




![image](https://github.com/radkesvat/RTCF/assets/134321679/773e8766-07c8-4196-9500-aa5afac97515)



![image](https://github.com/radkesvat/RTCF/assets/134321679/b3b29cdf-8ed2-4694-947d-e566b427c274)



خوب ؛ ثبت دامنه انجام شد حالا باید سرتیفکیت بگیریم ؛ برای سرتیفکیت گرفتن میتونید از certbot استفاده کنید و یه سرتیفیکیت برای دامنتون بگیرد که در نهایت به شما یه فایل .cert و یه فایل .key میده


آموزش گرفتن سرتفیکیت برای دامنه تقریبا همه جا هست و میتونید استفاده کنید پس من اموزش certbot رو نمیدم اما یه راه دیگه هم برای سرتیفکیت گرفتن خود کلود فلیر هست ؛ به این صورت که میاید در این بخش 

![image](https://github.com/radkesvat/RTCF/assets/134321679/3e7e821b-fdd0-4278-ab94-69fa3a93a0d9)


و روی Create Certificate کلیک میکنید

و سپس

![image](https://github.com/radkesvat/RTCF/assets/134321679/ccac58a4-a836-421e-9d62-9ddc88420932)


اگه بهتون ارور داد یعنی باید صبر کنید چند دقیقه تا دامنتون با کلود فلیر سینک بشه کامل و حدودا ۲۰ دقیقه اینا طول میکشه ؛ بعدش موفق میشید سرتیفکیت رو دریافت کنید و در ادامه به شما همچین چیزی رو نشون میده:

![image](https://github.com/radkesvat/RTCF/assets/134321679/b9e1c765-4af8-4dda-a991-ab09310e4b2d)


همونطور که میبینید ۲ تا فایل هست که میشه click to copy کرد ؛ روی اولین click to copy کلیک کنید و بعد یه فایل توی دستکاپ ایجاد کنید به اسم cert.cert و محتویات رو اونجا پیست کنید

همینکارو برای click to copy شماره ۲ هم انجام بدین و داخل فایل key.key قرار بدین.

نکته مهم اینکه این کار رو به هیچ عنوان داخل سیستم عامل ویندوز انجام ندین ! مستقیم داخل خود سرور لینوکسی فایل رو با nano بسازید و محتویات رو paste کنید ؛ اگه فایل رو توی ویندوز درست کنید بعد ببرید داخل سرور 
برنامه استارت نمیشه و کار نمیکنه !

و الان شما سرتفیکیت مورد نیاز رو گرفتید که ۱۵ سال هم معتبره 





و از این به بعد برنامه رو اینجوری اجرا میکنید:

در سرور خارج:

```sh
./RTCF --kharej --auto:off --domain:cdn.mydomain.ir ...
```

که مشخصه باید دامنه ای که توی کلود فلیر ثبت کردید رو با ساب درستش وارد کنید مثلا چون من سابم رو با کلمه cdn ساختم در نهایت دامنه میشه cdn.mydomain.ir



و در سرور ایران هم این تغییر رو انجام میدیم:
```sh
./RTCF  --iran --auto:off --cert:/root/mycert.cert --pkey:/root/mykey.key  --domain:cdn.mydomain.ir ...
```


اینجا هم مسیر فایل cert و key رو اضافه کردیم و تمام ؛ حالا دیگه از دامنه خودمون استفاده میشه برای انتقال ترافیک 


به جای ۳ نقطع هم ادامه دستور رو وارد کنید که مثل حالت auto:on بود.












